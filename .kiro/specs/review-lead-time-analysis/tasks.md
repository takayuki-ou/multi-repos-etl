# 実装計画

- [x] 1. LeadTimeAnalyzerクラスの基本実装
  - リードタイム計算ロジックの実装
  - 日時解析とリードタイム計算メソッドの作成
  - 基本的なエラーハンドリングの実装
  - _要件: 1.1, 1.2, 1.3_

- [x] 2. 統計計算エンジンの実装
  - [x] 2.1 基本統計計算メソッドの実装
    - 平均、中央値、最小値、最大値、標準偏差の計算機能を実装
    - NumPyを使用した効率的な統計計算の実装
    - _要件: 2.1, 2.4_

  - [x] 2.2 パーセンタイル分析機能の実装
    - 25、75、90パーセンタイルの計算機能を実装
    - IQR（四分位範囲）計算の実装
    - _要件: 2.2_

  - [x] 2.3 外れ値検出・除外機能の実装
    - IQR法による外れ値検出ロジックを実装
    - Z-score法による外れ値検出の実装
    - 外れ値除外後の統計再計算機能を実装
    - _要件: 2.3_

- [x] 3. DataManager拡張の実装
  - [x] 3.1 フィルタリング対応のデータ取得メソッド追加
    - リポジトリ、日付範囲、作成者によるフィルタリング機能を実装
    - SQLクエリの最適化とインデックス活用
    - _要件: 3.1, 3.2, 3.3_

  - [x] 3.2 フィルタ条件の組み合わせ処理実装
    - 複数フィルタのANDロジック実装
    - フィルタ結果が空の場合のハンドリング
    - _要件: 3.4, 3.5_

- [x] 4. トレンド分析機能の実装
  - [x] 4.1 期間別グループ化機能の実装
    - 週次・月次でのPRグループ化ロジックを実装
    - 期間別平均リードタイム計算の実装
    - _要件: 4.1, 4.2_

  - [x] 4.2 トレンド統計計算の実装
    - 前期間比変化率計算の実装
    - トレンド方向判定ロジックの実装
    - 複数リポジトリ対応のトレンド分析を実装
    - _要件: 4.3, 4.4_

- [x] 5. Streamlit UI基本実装
  - [x] 5.1 レビューリードタイム分析ページの追加
    - 既存app.pyにナビゲーションタブを追加
    - 基本的なページレイアウトの実装
    - リポジトリ選択との連携実装
    - _要件: 1.1_

  - [x] 5.2 フィルタUIコンポーネントの実装
    - 日付範囲選択UIの実装
    - 作成者フィルタ選択UIの実装
    - フィルタ適用ボタンとリセット機能の実装
    - _要件: 3.1, 3.2, 3.3_

- [ ] 6. 統計表示UIの実装
  - [ ] 6.1 基本統計メトリクス表示の実装
    - 平均、中央値、最小値、最大値の表示
    - Streamlitメトリクスコンポーネントを使用した視覚的表示
    - _要件: 2.1_

  - [ ] 6.2 パーセンタイル分布表示の実装
    - パーセンタイル値の表形式表示
    - 分布の可視化（ヒストグラムまたはボックスプロット）
    - _要件: 2.2_

  - [ ] 6.3 データ不足時の適切なメッセージ表示
    - PR件数が少ない場合の基本統計のみ表示
    - データが存在しない場合のメッセージ表示
    - _要件: 1.4, 2.4_

- [ ] 7. トレンド可視化の実装
  - [ ] 7.1 時系列チャートの実装
    - Streamlitのline_chartを使用したトレンド表示
    - 期間選択（週次/月次）機能の実装
    - _要件: 4.1, 4.2_

  - [ ] 7.2 複数リポジトリ対応の可視化
    - リポジトリ別トレンド表示機能
    - 統合トレンド表示機能
    - 表示切り替えUI の実装
    - _要件: 4.3_

- [ ] 8. CSVエクスポート機能の実装
  - [ ] 8.1 データエクスポート機能の実装
    - フィルタされたデータのCSV形式変換
    - 必要な列（PRタイトル、リポジトリ、作成者、日付、リードタイム）の出力
    - _要件: 5.1, 5.2_

  - [ ] 8.2 ダウンロード機能の実装
    - Streamlitのdownload_buttonを使用したファイルダウンロード
    - ファイル名の自動生成（日付付き）
    - フィルタ適用時のエクスポート対応
    - _要件: 5.3, 5.4_

- [ ] 9. エラーハンドリングとバリデーションの実装
  - [ ] 9.1 データ品質チェック機能の実装
    - PR日付データの妥当性検証
    - 不正な日付形式のハンドリング
    - 日付の論理的整合性チェック（作成日 < 終了日）
    - _要件: 1.2, 1.3_

  - [ ] 9.2 ユーザー入力バリデーションの実装
    - 日付範囲の妥当性チェック
    - フィルタ条件の検証
    - エラーメッセージの適切な表示
    - _要件: 3.5_

- [ ] 10. 単体テストの実装
  - [ ] 10.1 LeadTimeAnalyzerクラスのテスト
    - リードタイム計算ロジックのテストケース作成
    - 各種統計計算のテストケース作成
    - エッジケース（データなし、異常値）のテスト
    - _要件: 1.1, 2.1, 2.2_

  - [ ] 10.2 統計計算エンジンのテスト
    - 基本統計計算の正確性テスト
    - パーセンタイル計算のテスト
    - 外れ値除外機能のテスト
    - _要件: 2.1, 2.2, 2.3_

- [ ] 11. 統合テストとUI検証
  - [ ] 11.1 エンドツーエンドテストの実装
    - データ取得からUI表示までの統合テスト
    - フィルタリング機能の統合テスト
    - エクスポート機能の統合テスト
    - _要件: 3.4, 5.4_

  - [ ] 11.2 UIコンポーネントの動作検証
    - 各フィルタ機能の動作確認
    - 統計表示の正確性確認
    - エラーケースでの適切な表示確認
    - _要件: 1.4, 3.5_

- [ ] 12. パフォーマンス最適化とキャッシュ実装
  - [ ] 12.1 データ取得の最適化
    - 必要な列のみのSELECT実装
    - インデックス活用の確認
    - 大量データ対応のページネーション検討
    - _要件: 2.1_

  - [ ] 12.2 Streamlitキャッシュの実装
    - @st.cache_dataデコレータの適用
    - 統計計算結果のキャッシュ実装
    - キャッシュ無効化条件の設定
    - _要件: 2.1, 4.2_