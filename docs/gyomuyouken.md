## **GitHub PRログ分析システム 業務要件定義書**

### **1\. 目的**

本システムの目的は、開発チームがコードレビュープロセスにおけるコミュニケーションの実態を定量的に把握し、ボトルネックの特定や改善活動のための客観的なデータを提供することです。具体的には、複数リポジトリを横断したプルリクエストの会話ログを収集・分析し、会話の頻度、文字量、および会話に関連するリードタイムに関するメトリクスを提供します。

### **2\. スコープ**

* **対象データ:** 指定されたGitHubリポジトリのプルリクエスト、プルリクエストに対するIssueコメント、およびレビューコメント。  
* **分析対象期間:** システム稼働開始以降に取得されたデータ。  
* **提供メトリクス:**  
  * **会話頻度:** プルリクエストあたりのコメント数、ユーザーあたりのコメント数、指定期間（日次、週次など）のコメント数推移、会話参加者数。  
  * **文字数:** プルリクエストあたりの総コメント文字数、コメントあたりの平均文字数、ユーザーあたりの総コメント文字数。  
  * **会話関連リードタイム:** プルリクエスト作成から最初のコメントまでの時間 (Time to First Comment)、最後のコメントからPRクローズ/マージまでの時間 (Time from Last Comment to Close)、会話が活発に行われた期間（最初のコメントから最後のコメントまでの時間） (Conversation Duration)。  
* **対象リポジトリ:** システム設定により複数リポジトリを指定可能とします。

### **3\. 機能要件**

* 指定された複数GitHubリポジトリから、プルリクエストおよび関連するコメント（Issueコメント、レビューコメント）のデータを定期的に取得する機能。  
* 取得したデータをローカルホストされたPostgreSQLデータベースに蓄積する機能。既にデータベースに存在するデータとの差分（新規追加、更新）を適切に処理する機能。  
* データベースに蓄積されたデータを用いて、上記「提供メトリクス」を計算・集計する機能。  
* 計算されたメトリクスを、期間別、リポジトリ別、ユーザー別などの切り口で集計・表示する機能（レポート機能）。  
* 分析結果を視覚的に把握するための簡易的な可視化機能、または外部BIツールとの連携を考慮したデータ出力機能。

### **4\. ユースケース**

* **ユースケース 1: チームリーダーによるコードレビュープロセスのボトルネック特定**  
  * **アクター:** チームリーダー  
  * **シナリオ:** チームリーダーは、特定の期間において「最初のコメントがつくまでの時間」が長いプルリクエスト、「最後のコメントからクローズまでの時間」が長いPRを検知、担当レビュワーの業務を阻害している要因を調査する。  
* **ユースケース 2: 開発者による自身のレビュー貢献度確認**  
  * **アクター:** 開発者  
  * **シナリオ:** 開発者は、自分が担当したプルリクエストのコメント頻度や文字数、自分が投稿したコメント数や文字数を確認し、自身のコードレビューへの参加度合いやコミュニケーション量、レビューコメントの質（文字量から推測）を振り返る。  
* **ユースケース 3: エンジニアリングマネージャーによるリポジトリ間の比較**  
  * **アクター:** エンジニアリングマネージャー  
  * **シナリオ:** エンジニアリングマネージャーは、複数のチームが管理するリポジトリ間で「プルリクエストあたりのコメント数」や「会話期間」を比較し、チーム間のコードレビュー文化やコミュニケーション密度の違いを把握する。  
* **ユースケース 4: プロセス改善策による効果測定**  
  * **アクター:** プロセス改善担当者  
  * **シナリオ:** コードレビューのガイドライン変更やツールの導入を行ったプロセス改善担当者は、変更前後の期間で「コメントあたりの平均文字数」や「会話関連リードタイム」がどのように変化したかを分析し、改善施策の効果を測定する。

### **5\. 非機能要件**

* **認証:** GitHub APIへの接続認証は、適切な権限を持つユーザーのPersonal Access Token (PAT) を使用することを基本とします。業務要件にあるSSHによるリポジトリ接続認証は、APIによるデータ取得そのものに直接使用されるものではありませんが、データ取得に使用するPATが付与されるGitHubユーザーアカウントが、対象リポジトリへのアクセス権限をSSHキーによって管理されているアカウントである、という前提とします。  
* **データ取得頻度・量:** 毎日1回、定期的にデータを取得します。1日の新規/更新ログ件数は最大約100件程度を想定します。  
* **実行環境:** システムはローカルのMac OS環境上で動作するものとします。  
* **使用データベース:** ローカルホストされたPostgreSQLを使用します。  
* **可用性:** ローカルシステムのため、常時稼働は必須としません。データ取得および分析実行時にシステムが起動していることを前提とします。  
* **性能:** 毎日約100件程度のデータ量であれば、データ取得、DB投入、基本的な分析処理は短時間（数分以内）で完了することを目標とします。  
* **拡張性:** 対象リポジトリの追加、新しい分析メトリクスの追加に対して、比較的容易に対応できる設計とします。  
* **保守性:** データ取得処理のログ出力、エラー発生時の通知（標準出力など簡易的な方法で可）機能を備えます。